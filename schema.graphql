enum LoanStatus {
  REQUESTED
  ACCEPTED
  REPAID
  LIQUIDATED
  CANCELLED
  NFT_CLAIMED
}

type Loan @entity(immutable: false) {
  id: ID!
  status: LoanStatus!
  borrower: Bytes!
  token: Bytes!
  amount: BigInt!
  nftCollection: Bytes!
  nftId: BigInt!
  duration: BigInt!
  deadline: BigInt!
  interestRate: BigInt!
  collateralValue: BigInt!
  dueAmount: BigInt!
  lender: Bytes!
  startTime: BigInt!
  endTime: BigInt!
  totalPaid: BigInt!
  feePaid: BigInt!
  liquidator: Bytes!
  events: [Event!]! @derivedFrom(field: "loan")
}

type Event @entity(immutable: true) {
  live: Boolean!
  borrower: Bytes! # address
  token: Bytes! # address
  amount: BigInt! # uint256
  nft: Nft!
  duration: BigInt! # uint256
  interestRate: BigInt! # uint256
  collateralValue: BigInt! # uint256
  lender: Bytes! # address
  startTime: BigInt! # uint256
  endTime: BigInt! # uint256
  repaymentAmount: BigInt! # uint256
  paidAmount: BigInt! # uint256
  leftAmount: BigInt! # uint256
  events: [Event!]! @derivedFrom(field: "loan")
}

type Collection @entity {
  id: ID!
  address: Bytes! # address
  oracle: Bytes! # bytes32
}

type Nft @entity {
  id: ID!
  collection: Collection!
  tokenId: BigInt! # uint256
  valuationHistory: [Valuation!]
}

type Valuation @entity {
  id: ID!
  price: BigInt! # uint256
  ltv: BigInt! #Â uint256
  timestamp: BigInt! # uint256
}
